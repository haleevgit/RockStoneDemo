System.register("chunks:///_virtual/Events.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){var n;t._RF.push({},"910660i/8dMq6XP6HEejuWS","Events",void 0),function(e){e.ItemChosen="item_chosen",e.ItemDropped="item_dropped",e.ItemSet="item_set",e.INPUT="input"}(n||(n={}));e("default",n);t._RF.pop()}}}));

System.register("chunks:///_virtual/FieldWatcher.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Events.ts","./Item.ts"],(function(e){"use strict";var t,i,n,r,l,o,s,h,a,d,u,f,c,p,m,y;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){l=e.cclegacy,o=e._decorator,s=e.SpriteFrame,h=e.Node,a=e.Prefab,d=e.director,u=e.Vec2,f=e.instantiate,c=e.Sprite,p=e.Component},function(e){m=e.default},function(e){y=e.Item}],execute:function(){var g,v,b,F,C,_,I,w,x,A,S;l._RF.push({},"bbd0a3a4HhBT6uQk0Ek0fKE","FieldWatcher",void 0);var P=o.ccclass,M=o.property;e("FieldWatcher",(g=P("FieldWatcher"),v=M(s),b=M(h),F=M(a),g((I=t((_=function(e){function t(){for(var t,i=arguments.length,l=new Array(i),o=0;o<i;o++)l[o]=arguments[o];return t=e.call.apply(e,[this].concat(l))||this,n(t,"lengthField",I,r(t)),n(t,"heightField",w,r(t)),n(t,"spriteCell",x,r(t)),n(t,"inputCatcher",A,r(t)),n(t,"itemPrefab",S,r(t)),t.initialItems=void 0,t._sideSquare=0,t._fieldArray=[],t}i(t,e);var l=t.prototype;return l.onLoad=function(){this.initialItems=[1,1,2],this.makeCells(),this.makeItems(),this.inputCatcher.active=!1},l.onEnable=function(){this.handleSubscription(!0)},l.onDisable=function(){this.handleSubscription(!1)},l.handleSubscription=function(e){var t=e?"on":"off";d[t](m.ItemChosen,this.onItemChosen,this),d[t](m.ItemDropped,this.onItemDropped,this)},l.onItemDropped=function(e){var t=this.defineCell(e.getPosition()),i=this.node.getChildByName("h"+t.y+"l"+t.x).position;d.emit(m.ItemSet,i),this.fusionItems(e,t)},l.defineNumbers=function(e){for(var t=0;t<this.heightField;t++){var i=this._fieldArray[t].indexOf(e);if(-1!==i)return new u(i,t)}},l.onItemChosen=function(){this.inputCatcher.active=!0},l.defineCellPosition=function(e){return this.node.getChildByName("h"+e.y+"l"+e.x).position},l.defineCell=function(e){var t=Math.floor(e.x/this._sideSquare+this.lengthField/2-1)+1,i=Math.floor(e.y/this._sideSquare+this.heightField/2-1)+1;return new u(t,i)},l.makeItems=function(){for(var e=this.initialItems.length,t=0;t<e;t++){var i=f(this.itemPrefab),n=i.getComponent(y);n.type=this.initialItems[t],n.setType(n.type);var r=this.chooseNumbers(),l=this.node.getChildByName("h0l0").position;n.deltaX=-l.x,n.deltaY=-l.y,i.setParent(this.node);var o=this.node.getChildByName("h"+r.y+"l"+r.x);i.setPosition(o.position),this._fieldArray[r.y][r.x]=i}},l.makeCells=function(){if(this._sideSquare=this.spriteCell.height,this.lengthField&&this.heightField&&this.spriteCell)for(var e=0;e<this.heightField;e++){this._fieldArray[e]=[];for(var t=0;t<this.lengthField;t++){this._fieldArray[e][t]=null;var i=new h("h"+e+"l"+t);i.addComponent(c).spriteFrame=this.spriteCell,i.setParent(this.node),i.position.set((t-this.lengthField/2+.5)*this._sideSquare,(e-this.heightField/2+.5)*this._sideSquare)}}},l.fusionItems=function(e,t){var i=this._fieldArray[t.y][t.x];if(i!==e){var n=e,r=this.defineNumbers(e);if(i){var l=i.getComponent(y),o=null==e?void 0:e.getComponent(y);if(l.type===o.type)l.dropItem(),o.transformationItem(l.type+1);else{var s=t;t=this.findFreeCell(t,e),l.transferItem(this.defineCellPosition(t)),this._fieldArray[s.y][s.x]=n,n=i}}this._fieldArray[r.y][r.x]=null,this._fieldArray[t.y][t.x]=n}},l.chooseNumbers=function(){for(var e=new u(0,0);null!==this._fieldArray[e.y][e.x];)e=new u(Math.floor(Math.random()*this.lengthField),Math.floor(Math.random()*this.heightField));return e},l.findFreeCell=function(e,t){for(var i=new u(this.lengthField*this.heightField,0),n=this.heightField*this.lengthField,r=0;r<this.heightField;r++)for(var l=0;l<this.lengthField;l++)if(!this._fieldArray[r][l]||this._fieldArray[r][l]===t){var o=Math.sqrt(Math.pow(e.y-r,2)+Math.pow(e.x-l,2));o<n&&(n=o,i=new u(l,r))}return i},t}(p)).prototype,"lengthField",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),w=t(_.prototype,"heightField",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2}}),x=t(_.prototype,"spriteCell",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=t(_.prototype,"inputCatcher",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=t(_.prototype,"itemPrefab",[F],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),C=_))||C));l._RF.pop()}}}));

System.register("chunks:///_virtual/InputCatcher.ts",["./rollupPluginModLoBabelHelpers.js","cc","./Events.ts","./InputType.ts"],(function(t){"use strict";var n,e,o,i,s,u,c,r;return{setters:[function(t){n=t.inheritsLoose},function(t){e=t.cclegacy,o=t._decorator,i=t.Node,s=t.director,u=t.Component},function(t){c=t.default},function(t){r=t.default}],execute:function(){var p;e._RF.push({},"d55cdQHxk9L3ZlpZ7dMWYnQ","InputCatcher",void 0);var a=o.ccclass;t("InputCatcher",a("InputCatcher")(p=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var o=e.prototype;return o.onEnable=function(){this.handleSubscription(!0)},o.onDisable=function(){this.handleSubscription(!1)},o.handleSubscription=function(t){var n=t?"on":"off";this.node[n](i.EventType.MOUSE_MOVE,this.onMouseMove,this),this.node[n](i.EventType.MOUSE_UP,this.onMouseUp,this)},o.onMouseMove=function(t){s.emit(c.INPUT,r.Move,t,this)},o.onMouseUp=function(t){s.emit(c.INPUT,r.Up,t,this),this.node.active=!1},e}(u))||p);e._RF.pop()}}}));

System.register("chunks:///_virtual/InputType.ts",["cc"],(function(e){"use strict";var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){var t;n._RF.push({},"74deaK1zCtBLoO9WV0EKQXe","InputType",void 0),function(e){e[e.None=0]="None",e[e.Down=1]="Down",e[e.Move=2]="Move",e[e.Up=3]="Up",e[e.Cancel=4]="Cancel"}(t||(t={}));e("default",t);n._RF.pop()}}}));

System.register("chunks:///_virtual/Item.ts",["./rollupPluginModLoBabelHelpers.js","cc","./ItemType.ts","./InputType.ts","./Events.ts"],(function(t){"use strict";var e,i,n,o,s,r,a,c,u,h,l,p,d,f;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,o=t.assertThisInitialized},function(t){s=t.cclegacy,r=t._decorator,a=t.Node,c=t.director,u=t.Vec3,h=t.Animation,l=t.Component},function(t){p=t.default},function(t){d=t.default},function(t){f=t.default}],execute:function(){var g,m,y,I,b,v,D,_;s._RF.push({},"f2135aoczNOuY27AmEZZ+tb","Item",void 0);var S=r.ccclass,w=r.property;t("Item",(g=S("Item"),m=w(a),y=w(a),g((v=e((b=function(t){function e(){for(var e,i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return e=t.call.apply(t,[this].concat(s))||this,n(e,"shine",v,o(e)),n(e,"InputC",D,o(e)),n(e,"type",_,o(e)),e._isDragging=!1,e._stopDragging=!1,e.deltaX=0,e.deltaY=0,e}i(e,t);var s=e.prototype;return s.onEnable=function(){this.handleSubscription(!0)},s.onDisable=function(){this.handleSubscription(!1)},s.handleSubscription=function(t){var e=t?"on":"off";this.InputC[e](a.EventType.TOUCH_START,this.onDown,this),c[e](f.INPUT,this.onInput,this)},s.onInput=function(t,e){if(this._isDragging&&!this._stopDragging)switch(t){case d.Move:var i=new u(e.getDeltaX(),e.getDeltaY(),0),n=this.node.position.clone().add(i);if(n.x<-this.deltaX||n.x>this.deltaX||n.y<-this.deltaY||n.y>this.deltaY)return;this.node.setPosition(n.x,n.y,0);break;case d.Up:c.on(f.ItemSet,this.onItemSet,this),c.emit(f.ItemDropped,this.node,this.type),this._isDragging=!1}},s.onDown=function(t){this._stopDragging||(this._isDragging=!0,c.emit(f.ItemChosen),this.node.setSiblingIndex(1e3))},s.onItemSet=function(t){this.node.setPosition(t),c.off(f.ItemSet,this.onItemSet,this)},s.setType=function(t){this.node.children[t].active=!0},s.dropItem=function(){this.handleSubscription(!1),this.node.destroy()},s.transformationItem=function(t){var e=this;this._stopDragging=!0,this.node.children[this.type].active=!1,this.shine.active=!0,this.shine.getComponent(h).play(),this.scheduleOnce((function(){e.shine.active=!1,e.node.children[t].active=!0,e.type=t,e._stopDragging=!1}),1)},s.transferItem=function(t){this.node.setPosition(t)},e}(l)).prototype,"shine",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=e(b.prototype,"InputC",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(b.prototype,"type",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return p.Flower1}}),I=b))||I));s._RF.pop()}}}));

System.register("chunks:///_virtual/ItemType.ts",["cc"],(function(e){"use strict";var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){var o;t._RF.push({},"00d62EDjh9E3q3UdJ3D0yF6","ItemType",void 0),function(e){e[e.None=0]="None",e[e.Flower1=1]="Flower1",e[e.Flower2=2]="Flower2",e[e.BonusBox=3]="BonusBox"}(o||(o={}));e("default",o);t._RF.pop()}}}));

System.register("chunks:///_virtual/main",["./Events.ts","./FieldWatcher.ts","./InputCatcher.ts","./InputType.ts","./Item.ts","./ItemType.ts"],(function(){"use strict";return{setters:[null,null,null,null,null,null],execute:function(){}}}));
